[{"path":"/articles/Introduction.html","id":"introducing-the-mvtweedie-distribution-for-regression-based-analysis-of-stomach-contents","dir":"Articles","previous_headings":"","what":"Introducing the mvtweedie distribution for regression-based analysis of stomach contents","title":"Introduction to mvtweedie","text":"mvtweedie n R package interpret Tweedie generalized linear model (GLM) generalized additive model (GAM) involving multiple classes estimate proportions class, implicitly involving multivariate-logit transformation parameters predictions. approach generalizes Poisson--multinomial transformation allow non-integer responses, can analyze either pre-processed (transformed proportions) raw (zero-inflated positive real values) data. approach helpful, e.g., analyzing diet samples heavily zero inflated without pre-processing samples prior analysis. cases, Tweedie distribution can interpreted mechanistically thinned double-marked Poisson point process representing foraging processes.","code":"library(mvtweedie)"},{"path":"/articles/Introduction.html","id":"example-application-for-tuften-puffins-on-middleton-island","dir":"Articles","previous_headings":"Introducing the mvtweedie distribution for regression-based analysis of stomach contents","what":"Example application for tuften puffins on Middleton Island","title":"Introduction to mvtweedie","text":"apply method, first format data long-form data frame, includes row combination prey sample, columns prey group sample ID, measured quantity diet sample prey, predictor /offset variables. fit log-linked regression model prey samples, multiple responses sample. case, use mgcv fit Generalized Additive Model (GAM) specifically include: smoothing term s(Year) shared among prey groups, representing variation time expected prey biomass stomach; smoothing term s(Year,=group) differs among prey groups, representing prey switching time; group-specific intercept 0 + group represents expected differences prey proportion time first term essentially “detectability” covariate, representing changes attack capture rates time. replaced fixed random effect sample, although model slow using mgcv. equal effect predicted measurements prey category (due us using log-linked model), therefore “drops ” predicting prey proportions. Alternatively, pre-process data sample constant mean prey density. (rougly) similar marginalizing across unmodeled variation total prey measurement sample. fitted GAM gam0 include covariance response prey species (conditional upon estimated response terms included formula). However, predict(mygam) now predict response proportions across modeled categories, include negative covariance among categories.","code":"# load data set data( Middleton_Island_TUPU, package=\"mvtweedie\" ) Middleton_Island_TUPU$Year = as.numeric(as.character( Middleton_Island_TUPU$Year_factor ))  # Illustrate format knitr::kable( head(Middleton_Island_TUPU), digits=1, row.names=FALSE) # Run Tweedie GLM library(mgcv) gam0 = gam( formula = Response ~ 0 + group + s(Year,by=group) + s(Year),                   data = Middleton_Island_TUPU,                   family = tw )  # Load class to enable predict.mvtweedie mygam = gam0 class(mygam) = c( \"mvtweedie\", class(mygam) )"},{"path":"/articles/Introduction.html","id":"visualizing-covariate-responses","dir":"Articles","previous_headings":"","what":"Visualizing covariate responses","title":"Introduction to mvtweedie","text":"fitting model, can visualize predicted proportion prey function covariates. simple example, can manually construct predictive grid covariate Year, calculate predictions, plot using ggplot.  complicated models, however, might cumbersome construct full grid across covariates. can instead automate process using third-party packages. , show use pdp calculate partial dependence plot:   simple example, partial dependence plot predictive grid result visualization effects. However, guarunteed case models covariates.","code":"# Predict values newdata = expand.grid( \"group\" = levels(Middleton_Island_TUPU$group),                        \"Year\" = 1978:2018 ) pred = predict( mygam,                 se.fit = TRUE,                 origdata = Middleton_Island_TUPU,                 newdata = newdata ) newdata = cbind( newdata, fit=pred$fit, se.fit=pred$se.fit ) newdata$lower = newdata$fit - newdata$se.fit newdata$upper = newdata$fit + newdata$se.fit  # Plot library(ggplot2) theme_set(theme_bw()) ggplot(newdata, aes(Year, fit)) +   geom_pointrange(aes(ymin = lower, ymax = upper)) +   facet_wrap(vars(group)) +   scale_color_viridis_c(name = \"SST\") +   ylim(0,1) +   labs(y=\"Predicted proportion\") library(pdp)  # Make function to interface with pdp pred.fun = function( object, newdata ){   predict( object = object,            origdata = object$model,            category_name = \"group\",            newdata = newdata ) }  # Calculate partial dependence # approx = TRUE gives effects for average of other covariates # approx = FALSE gives each pdp curve Partial = partial( object = mygam,                    pred.var = c( \"Year\", \"group\"),                    pred.fun = pred.fun,                    train = mygam$model,                    approx = TRUE )  # Lattice plots as default option library( lattice ) plotPartial( Partial ) # using in ggplot2 ggplot(data=Partial, aes(x=Year, y=yhat)) + # , group=yhat.id   geom_line( ) +   facet_grid( vars(group) ) +   labs(y=\"Predicted proportion\")"},{"path":"/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"James Thorson. Author, maintainer.","code":""},{"path":"/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Thorson, J. T., Arimitsu, M. L., Levi, T., & Roffler, G. H. (2022). Diet analysis using generalized linear models derived foraging processes using R package mvtweedie. Ecology, 103(5), e3637. https://doi.org/10.1002/ecy.3637","code":"@Article{,   title = {Diet analysis using generalized linear models derived from foraging processes using R package mvtweedie},   journal = {Ecology},   volume = {103},   number = {5},   pages = {e3637},   year = {2022},   doi = {doi.org/10.1002/ecy.3637},   url = {https://doi.org/10.1002/ecy.3637},   author = {J. T. Thorson and Mayumi L. Arimitsu and Taal Levi and Gretchen Roffler}, }"},{"path":"/index.html","id":"mvtweedie","dir":"","previous_headings":"","what":"Fit multivariate logit Tweedie model using mgcv or glmmTMB","title":"Fit multivariate logit Tweedie model using mgcv or glmmTMB","text":"R package interpret Tweedie generalized linear model (GLM) generalized additive model (GAM) involving multiple classes estimate proportions class, implicitly involving multivariate-logit transformation parameters predictions. approach generalizes Poisson--multinomial transformation allow non-integer responses, can analyze either pre-processed (transformed proportions) raw (zero-inflated positive real values) data. approach helpful, e.g., analyzing diet samples heavily zero inflated without pre-processing samples prior analysis. cases, Tweedie distribution can interpreted mechanistically thinned double-marked Poisson point process representing foraging processes.","code":""},{"path":"/index.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Fit multivariate logit Tweedie model using mgcv or glmmTMB","text":"Thorson, J. T., Arimitsu, M. L., Levi, T., & Roffler, G. (2022). Diet analysis using generalized linear models derived foraging processes using R package mvtweedie. Ecology. 103(5): e3637.","code":""},{"path":"/reference/Middleton_Island_TUPU.html","id":null,"dir":"Reference","previous_headings":"","what":"Middleton Island tufted puffin diets — Middleton_Island_TUPU","title":"Middleton Island tufted puffin diets — Middleton_Island_TUPU","text":"Data demonstrate test multivariate logit Tweedie model","code":""},{"path":"/reference/Middleton_Island_TUPU.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Middleton Island tufted puffin diets — Middleton_Island_TUPU","text":"","code":"data(Middleton_Island_TUPU)"},{"path":"/reference/Middleton_Island_TUPU.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Middleton Island tufted puffin diets — Middleton_Island_TUPU","text":"data long-form data frame","code":""},{"path":"/reference/Middleton_Island_TUPU.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Middleton Island tufted puffin diets — Middleton_Island_TUPU","text":"Data sufficient demonstrate use Tweedie GLM provide inference proportions e.g. food habits analysis, model output processed represent multivariate logit Tweedie model. Specifically includes Tufted Puffin (Fratercula cirrhata) bill loads sampled Middleton Island. Response Numeric prey biomass bill load samples Year Numeric year group factor representing prey species category SampleID factor level every sampling occasion, e.g., use row normalization","code":""},{"path":"/reference/Middleton_Island_TUPU.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Middleton Island tufted puffin diets — Middleton_Island_TUPU","text":"Hatch, S., G. Sanger. 1992. Puffins Samplers Juvenile Pollock Forage Fish Gulf Alaska. Marine Ecology Progress Series 80: 1-14.","code":""},{"path":"/reference/Middleton_Island_TUPU.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Middleton Island tufted puffin diets — Middleton_Island_TUPU","text":"Mayumi Arimitsu","code":""},{"path":"/reference/mvtweedie.html","id":null,"dir":"Reference","previous_headings":"","what":"Multivariate Tweedie distribution for predicting diet proportions — mvtweedie","title":"Multivariate Tweedie distribution for predicting diet proportions — mvtweedie","text":"Using regression methods analyze diet proportions marked point process","code":""},{"path":"/reference/mvtweedie.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Multivariate Tweedie distribution for predicting diet proportions — mvtweedie","text":"Diet samples often measure count biomass different prey categories. Rather converting data proportion fitting modelling proportions, can instead represent diet samples outcome thinnned double-marked point process, marks include prey size per encounter, prey category, thinning represents variation attack capture rates conceptually similar detectability/catchability point-count sampling analyses. Analyzing raw prey measurements (rather proportions) regression model allows wide range models (associated --shelf software) predictions can converted proportions (associated standard errors) model fitted.  prey densities follow Poisson point-process, prey size per encounter follows gamma distribution, resulting distribution biomass prey follows multivariate Tweedie distribution.","code":""},{"path":"/reference/mvtweedie.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Multivariate Tweedie distribution for predicting diet proportions — mvtweedie","text":"Thorson, J. T., Arimitsu, M. L., Levi, T., & Roffler, G. H. (2022). Diet analysis using generalized linear models derived foraging processes using R package mvtweedie. Ecology, 103(5), e3637. doi:10.1002/ecy.3637","code":""},{"path":"/reference/predict.mvtweedie.html","id":null,"dir":"Reference","previous_headings":"","what":"Predict proportions for new data — predict.mvtweedie","title":"Predict proportions for new data — predict.mvtweedie","text":"Predict proportions associated standard errors using standard S3 object interface","code":""},{"path":"/reference/predict.mvtweedie.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Predict proportions for new data — predict.mvtweedie","text":"","code":"# S3 method for mvtweedie predict(   object,   category_name = \"group\",   newdata,   origdata = object$model,   se.fit = FALSE,   ... )"},{"path":"/reference/predict.mvtweedie.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Predict proportions for new data — predict.mvtweedie","text":"object output gam glmmTMB, class(object)=c(\"mvtweedie\",...) ... indicates original values class(object) category_name name column indicates grouping variable newdata optional data frame look variables     predict.  omitted, fitted values used. origdata original data used fitting se.fit switch indicating standard errors required. ... arguments passed methods.","code":""},{"path":"/reference/predict.mvtweedie.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Predict proportions for new data — predict.mvtweedie","text":"predict.mvtweedie produces vector predicted proportions list containing predicted proportions standard errors.","code":""},{"path":"/reference/predict.mvtweedie.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Predict proportions for new data — predict.mvtweedie","text":"Tweedie GLM using log-link multiple categories can transformed yield predicted proportions associated SEs, model interpreted multivariate logit Tweedie distribution. function transformation model fitted using: generalized additive model (GAM) using gam generalized linear mixed model (GLMM) using glmmTMB also calculates approximation standard error proportion","code":""},{"path":"/reference/predict.mvtweedie.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Predict proportions for new data — predict.mvtweedie","text":"","code":"# Load packages library(mvtweedie)  # load data set data( Middleton_Island_TUPU, package=\"mvtweedie\" ) DF = Middleton_Island_TUPU  # Run Tweedie GLM gam0 = mgcv::gam( formula = Response ~ 0 + group, data = DF, family = tw ) #> Error in eval(expr, envir, enclos): object 'tw' not found  # Inspect results class(gam0) = c( \"mvtweedie\", class(gam0) ) #> Error in eval(expr, envir, enclos): object 'gam0' not found predict(gam0, se.fit=TRUE, origdata = DF) #> Error in eval(expr, envir, enclos): object 'gam0' not found"}]
